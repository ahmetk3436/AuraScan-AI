{
  "tasks": [
    {
      "id": "enhance_002",
      "title": "Backend: Add base64 image upload endpoint for aura scanning",
      "description": "CRITICAL: The mobile app sends a local file URI (e.g., file:///var/mobile/.../photo.jpg) as image_url to POST /aura/scan, but the OpenAI Vision API needs either a real URL or base64 data. The backend must accept base64-encoded image data.\n\nFile: backend/internal/dto/aura.go\n- Change CreateAuraRequest to accept `image_data` (base64 string) instead of `image_url` (URL). Add field: ImageData string `json:\"image_data\" validate:\"required\"`. Remove the URL validation on image_url or make it optional.\n\nFile: backend/internal/services/aura_service.go\n- In the Create() method (~line 163), check if req.ImageData is provided. If so, use it as the base64 content for the OpenAI Vision API call.\n- In callOpenAIVision(), change the image_url content part to use a base64 data URI: `data:image/jpeg;base64,\u003cimage_data\u003e` format instead of a URL. OpenAI Vision API supports base64 via: {\"type\":\"image_url\",\"image_url\":{\"url\":\"data:image/jpeg;base64,...\"}}.\n- Store a placeholder string like \"base64_upload\" in the ImageURL model field since the original image doesn't need to be stored long-term.\n- Keep the existing URL path as fallback for backwards compatibility.\n\nFile: backend/internal/handlers/aura_handler.go\n- Update Scan handler to support larger body sizes. The main.go already sets BodyLimit to 4MB which is sufficient for compressed selfies.\n- Add request body size validation: reject if image_data exceeds 3MB base64 (roughly 2.25MB image).\n\nThis unblocks the entire scan flow â€” without this change, OpenAI gets a local file:// URI it cannot access.",
      "status": "in_progress",
      "priority": 10,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": "2026-02-06T23:08:02Z"
    },
    {
      "id": "enhance_003",
      "title": "Mobile: Send base64 image data instead of file URI in scan flow",
      "description": "CRITICAL: The mobile app currently sends `image_url: result.assets[0].uri` (a local file:// path) to POST /aura/scan. The backend cannot forward a local URI to OpenAI. Must convert the image to base64 before sending.\n\nFile: mobile/app/(protected)/home.tsx\n- Import `* as FileSystem` from 'expo-file-system' (already in package.json via expo).\n- In handleScan(), after ImagePicker returns a result, read the file as base64:\n  ```\n  const base64 = await FileSystem.readAsStringAsync(result.assets[0].uri, {\n    encoding: FileSystem.EncodingType.Base64,\n  });\n  ```\n- Change the API call from `api.post('/aura/scan', { image_url: result.assets[0].uri })` to `api.post('/aura/scan', { image_data: base64 })`.\n- Remove the artificial 2500ms mock delay (`await new Promise(resolve =\u003e setTimeout(resolve, 2500))` at line 86). The real OpenAI API call takes 2-5 seconds naturally â€” no fake delay needed.\n- Add a scanning state message: while isScanning is true, show a text like \"Reading your energy...\" below the ScanButton. Use an animated opacity pulse (Reanimated useSharedValue with withRepeat/withTiming from 0.4 to 1.0, 1s duration).\n- Keep quality: 0.7 in ImagePicker config to keep base64 size reasonable (\u003c1MB).\n\nFile: mobile/lib/api.ts\n- Increase axios timeout from 15000 to 30000ms to accommodate OpenAI Vision API processing time (can take 5-15 seconds for image analysis).",
      "status": "pending",
      "priority": 10,
      "depends_on": [
        "enhance_002"
      ],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_004",
      "title": "Mobile: Add 3-screen onboarding flow with AsyncStorage tracking",
      "description": "The app currently has NO onboarding â€” users go directly to login. Must add a 3-screen onboarding flow that shows only on first launch.\n\nFile: mobile/app/onboarding.tsx (CREATE)\n- Use useState for currentPage (0, 1, 2). Render each page as a full-screen View.\n- Page 0 (Welcome): Large AuraOrb component (size 180) with color='violet', title \"Discover Your Aura\" in text-3xl font-bold text-white, subtitle \"Your energy tells a story. Let's read it together.\" in text-base text-gray-400 text-center, bg-gray-950.\n- Page 1 (Features): Three feature rows with icons (sparkles/camera/people from Ionicons, size 32, color #8b5cf6/#22c55e/#ec4899), titles (\"AI-Powered Analysis\"/\"Selfie Scanning\"/\"Friend Matching\"), descriptions. Each row: flex-row items-center mx-8 my-4 with icon in h-16 w-16 rounded-full bg-violet-600/20 items-center justify-center.\n- Page 2 (CTA): Large sparkles icon, title \"Ready to Begin?\", two buttons: \"Try Free\" (bg-violet-600 rounded-full py-4 mx-8) calls handleGuestStart, \"Sign In\" (border border-gray-600 rounded-full py-4 mx-8 mt-3) navigates to /(auth)/login.\n- Page indicator: 3 dots at bottom (h-2 w-2 rounded-full, active: bg-violet-500, inactive: bg-gray-600, mx-1).\n- Navigation: \"Next\" button (right arrow) on pages 0-1, swipeable via ScrollView with pagingEnabled and horizontal.\n- On completion: `await AsyncStorage.setItem('onboarding_complete', 'true')` then navigate.\n- handleGuestStart: sets `await AsyncStorage.setItem('guest_mode', 'true')` and navigates to /(protected)/home.\n\nFile: mobile/app/index.tsx (MODIFY)\n- Import AsyncStorage from '@react-native-async-storage/async-storage'.\n- Before auth check, check `const onboarded = await AsyncStorage.getItem('onboarding_complete')`. If not onboarded, redirect to /onboarding.\n- After onboarding check, check `const isGuest = await AsyncStorage.getItem('guest_mode')`. If guest and not authenticated, redirect to /(protected)/home.\n\nFile: mobile/app/_layout.tsx (MODIFY)\n- Add 'onboarding' to the Stack.Screen list so the route works.\n\nNote: AsyncStorage is available via '@react-native-async-storage/async-storage' which is a dependency of expo-router.",
      "status": "pending",
      "priority": 8,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_005",
      "title": "Mobile: Add guest mode with 3-free-scan counter and upgrade prompts",
      "description": "The app requires authentication for ALL features. Must allow 3 free scans without login.\n\nFile: mobile/contexts/AuthContext.tsx (MODIFY)\n- Add `isGuest: boolean` to AuthContextType and state. Initialize by checking `AsyncStorage.getItem('guest_mode')`.\n- Add `enterGuestMode()` method: sets `AsyncStorage.setItem('guest_mode', 'true')`, sets isGuest=true.\n- Add `getGuestScansRemaining()`: reads `AsyncStorage.getItem('guest_scan_count')`, returns 3 minus count (or 3 if null).\n- Add `incrementGuestScan()`: reads current count, increments, saves to AsyncStorage. Returns new remaining count.\n- Export isGuest in context value.\n\nFile: mobile/app/(protected)/_layout.tsx (MODIFY)\n- Change the auth guard: instead of `if (!isAuthenticated) return \u003cRedirect\u003e`, check `if (!isAuthenticated \u0026\u0026 !isGuest) return \u003cRedirect href=\"/(auth)/login\" /\u003e`.\n- Import isGuest from AuthContext.\n\nFile: mobile/app/(protected)/home.tsx (MODIFY)\n- Import `useAuth` and get `isGuest, isAuthenticated, getGuestScansRemaining, incrementGuestScan`.\n- Before handleScan API call, if isGuest: check remaining scans via getGuestScansRemaining(). If 0, show Alert with title \"Free Scans Used\" message \"Create an account to keep scanning!\" and buttons [\"Sign Up\" â†’ router.push('/(auth)/register'), \"Cancel\"]. Return early.\n- After successful scan (if guest), call incrementGuestScan().\n- Show remaining scans badge for guests: a small pill below the scan button showing \"{remaining} free scans left\" in text-xs text-violet-400 with bg-violet-600/20 rounded-full px-3 py-1.\n- For guest users, hide the Quick Actions \"Compare with Friend\" card (match requires auth).\n\nFile: mobile/app/(auth)/login.tsx (MODIFY)\n- Add a \"Skip for now\" link below the Sign Up link. Style: text-gray-400 text-sm mt-4 text-center. On press: call enterGuestMode() from AuthContext then router.replace('/(protected)/home').",
      "status": "pending",
      "priority": 8,
      "depends_on": [
        "enhance_004"
      ],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_006",
      "title": "Mobile: Redesign auth screens with dark theme and gradient accents",
      "description": "Login and register screens use a plain white background that clashes with the dark-themed protected screens. Must unify the design.\n\nFile: mobile/app/(auth)/login.tsx (MODIFY)\n- Change outer KeyboardAvoidingView className from 'flex-1 bg-white' to 'flex-1 bg-gray-950'.\n- Add a hero section at top: View with items-center, containing an AuraOrb (import from components/aura/AuraOrb) with color='violet' and size={100}, then app name \"AuraSnap\" in text-2xl font-bold text-white mt-4, tagline \"Discover your energy\" in text-sm text-gray-400.\n- Change title \"Welcome back\" from text-gray-900 to text-white.\n- Change subtitle from text-gray-500 to text-gray-400.\n- Change error box from bg-red-50 to bg-red-900/30 rounded-xl, error text from text-red-600 to text-red-400.\n- Update Input components: the Input component already handles dark mode if placeholderTextColor is set. Ensure the Input label text is text-gray-300 and input bg is bg-gray-800.\n- Change Button primary variant to use bg-violet-600 instead of bg-primary-600 (which may not resolve in NativeWind).\n- Change \"Don't have an account?\" text from text-gray-500 to text-gray-400.\n- Change \"Sign Up\" link from text-primary-600 to text-violet-400 font-semibold.\n\nFile: mobile/app/(auth)/register.tsx (MODIFY)\n- Apply same dark theme changes: bg-gray-950, text-white titles, text-gray-400 subtitles, bg-red-900/30 error box, text-violet-400 links.\n- Add AuraOrb hero at top matching login screen.\n\nFile: mobile/components/ui/Input.tsx (MODIFY)\n- Update default styling: change bg-white to bg-gray-800, border-gray-300 to border-gray-700, text color to text-white, label to text-gray-300.\n- Focus border: change to border-violet-500.\n\nFile: mobile/components/ui/Button.tsx (MODIFY)\n- Update primary variant: change bg-blue-600/bg-primary-600 to bg-violet-600. active:bg-violet-700.\n- Update text for primary: ensure text-white.\n- Add hapticLight() import and call on press for all buttons.",
      "status": "pending",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_007",
      "title": "Mobile: Enhance aura detail screen with shareable gradient card",
      "description": "The aura detail screen (aura/[id].tsx) needs a polished shareable result card with gradient background, and the share feature should capture it as an image.\n\nFile: mobile/app/(protected)/aura/[id].tsx (MODIFY)\n- Add a visually rich result card section wrapped in a View with ref (for future screenshot capture).\n- Above the AuraOrb, add a gradient-like header using nested Views: outermost View with rounded-3xl overflow-hidden, an inner View with the aura's color as bg (use the existing colorMap), opacity-20, absolute fill. This creates a colored card effect.\n- Card layout: AuraOrb centered (size 160), aura color label below in text-2xl font-bold text-white text-center, secondary color as a small pill badge (if present) with bg-{color}/20 rounded-full px-3 py-1 text-xs.\n- Stats row below card: two stat boxes side by side â€” Energy (flash icon + level%) and Mood (emoji + score/10). Each in flex-1 items-center rounded-xl bg-gray-800/50 p-4.\n- Personality section: keep PersonalityCard but add a subtle top border (border-t border-gray-800 pt-6 mt-6).\n- Share button: change from simple text share to generating a formatted share message that includes:\n  ```\n  âœ¨ My AuraSnap Reading âœ¨\n  \n  ðŸ”® {COLOR} Aura â€” {label}\n  âš¡ Energy: {level}% | ðŸŽ­ Mood: {score}/10\n  \n  ðŸ’« {personality snippet first 100 chars}...\n  \n  Download AuraSnap to discover YOUR aura! ðŸŒˆ\n  ```\n- Add a \"Compare with Friend\" CTA button below share: bg-pink-600 rounded-full py-4, navigates to /match.\n- Add hapticSuccess() when the detail screen finishes loading.\n\nFile: mobile/components/aura/AuraOrb.tsx (MODIFY)\n- Add an optional `label` prop (string). If provided, render the label centered below the orb in text-sm font-medium text-gray-300.",
      "status": "pending",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_008",
      "title": "Mobile: Fix settings screen restore purchases and share functionality",
      "description": "Settings screen has several broken or placeholder features that must be fixed for production.\n\nFile: mobile/app/(protected)/settings.tsx (MODIFY)\n\n1. FIX Restore Purchases (line 125-128):\n- Currently just shows an Alert with static text, doesn't actually restore.\n- Import `useSubscription` from '../../contexts/SubscriptionContext'.\n- Get `handleRestore` from useSubscription().\n- Replace the handleRestorePurchases function body with:\n  ```\n  hapticMedium();\n  const restored = await handleRestore();\n  if (restored) {\n    hapticSuccess();\n    Alert.alert('Success', 'Your purchases have been restored!');\n  } else {\n    Alert.alert('No Purchases Found', 'We could not find any previous purchases.');\n  }\n  ```\n\n2. FIX Share App (line 111-118):\n- Currently uses Linking.openURL to a placeholder Apple URL that doesn't exist yet.\n- Import { Share } from 'react-native'.\n- Replace handleShareApp with:\n  ```\n  hapticSelection();\n  await Share.share({\n    message: 'âœ¨ Check out AuraSnap â€” discover your aura energy with AI! Download now: https://apps.apple.com/app/aurasnap',\n  });\n  ```\n- This uses the native share sheet (works even before App Store listing).\n\n3. FIX Biometric Toggle Persistence:\n- Import AsyncStorage from '@react-native-async-storage/async-storage'.\n- On mount (in useEffect), load: `const saved = await AsyncStorage.getItem('biometric_enabled'); if (saved === 'true') setBiometricEnabled(true);`\n- In the Switch onValueChange, save: `await AsyncStorage.setItem('biometric_enabled', String(newValue)); setBiometricEnabled(newValue);`\n- Add hapticSelection() on toggle.\n\n4. ADD Privacy Policy link:\n- After the \"Rate Us\" row, add a \"Privacy Policy\" row with Ionicons name=\"shield-outline\" size={20} color=\"#6b7280\" in bg-gray-600/20 circle. On press: `Linking.openURL('https://aurasnap.app/privacy')`. This satisfies Apple Guideline 5.1.\n\n5. ADD \"Go Premium\" button for non-subscribers:\n- Import useSubscription, get isSubscribed.\n- If !isSubscribed, show a prominent card above the App section: bg-gradient using nested Views with bg-violet-900/50 rounded-2xl p-5. Content: sparkles icon, \"Unlock Premium\" title in text-lg font-bold text-white, \"Unlimited scans, no ads, full history\" in text-sm text-gray-300, and a \"Upgrade\" button (bg-violet-600 rounded-full py-3 mt-3). On press: router.push('/paywall').",
      "status": "pending",
      "priority": 7,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_009",
      "title": "Backend: Add image upload endpoint with multipart form support",
      "description": "Alternative robust approach: Instead of base64 in JSON body, add a dedicated multipart file upload endpoint that stores the image temporarily and passes it to OpenAI.\n\nFile: backend/internal/handlers/aura_handler.go (MODIFY)\n- Add a new handler method ScanWithUpload(c *fiber.Ctx) that accepts multipart/form-data.\n- Extract file from form: `file, err := c.FormFile(\"image\")`. Validate: must be image/jpeg or image/png, max 4MB.\n- Read file content into memory: open file, read bytes, encode to base64.\n- Create a CreateAuraRequest with the base64 data and call auraService.Create().\n- Return 201 with the aura reading response.\n\nFile: backend/internal/routes/routes.go (MODIFY)\n- Add new route: `aura.Post(\"/scan/upload\", auraHandler.ScanWithUpload)` â€” this keeps backward compatibility with the existing /scan endpoint.\n\nFile: backend/internal/services/aura_service.go (MODIFY)\n- Ensure the Create method and callOpenAIVision support receiving base64 image data.\n- In callOpenAIVision, when imageURL starts with \"data:image\" or is pure base64, use the data URI format for OpenAI: {\"type\":\"image_url\",\"image_url\":{\"url\":\"data:image/jpeg;base64,\u003cdata\u003e\",\"detail\":\"low\"}}.\n- Use \"detail\":\"low\" to reduce token cost (OpenAI charges per image tile â€” low detail uses 1 tile = ~85 tokens vs high detail = many tiles).\n- If imageURL is a regular https:// URL, pass it directly (backward compatible).\n\nThis provides TWO paths for the mobile app: JSON with base64, or multipart upload. The multipart approach is more standard for mobile apps and handles larger images better.",
      "status": "pending",
      "priority": 9,
      "depends_on": [
        "enhance_002"
      ],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_010",
      "title": "Mobile: Add pull-to-refresh on home screen and improve empty/loading states",
      "description": "Home screen lacks pull-to-refresh and has minimal loading/empty states. Must polish for App Store quality.\n\nFile: mobile/app/(protected)/home.tsx (MODIFY)\n\n1. ADD Pull-to-Refresh:\n- Import { RefreshControl } from 'react-native'.\n- Add `const [refreshing, setRefreshing] = useState(false);`\n- Add onRefresh callback: `setRefreshing(true); await Promise.all([fetchTodayAura(), fetchStreak()]); setRefreshing(false);`\n- Add refreshControl prop to ScrollView: `\u003cRefreshControl refreshing={refreshing} onRefresh={onRefresh} tintColor=\"#8b5cf6\" /\u003e`\n\n2. IMPROVE Loading State:\n- When isLoading is true (initial load), instead of showing nothing, show a skeleton-like layout:\n  - A View with items-center mt-20 containing: AuraOrb (color='violet', size=120) with animated opacity (useSharedValue, withRepeat, withTiming 0.3â†’1.0, 1.5s), text \"Loading your aura...\" in text-gray-400 mt-4.\n  - Import Animated from 'react-native-reanimated' and use animatedStyle.\n\n3. IMPROVE Empty State (when no todayAura and not loading):\n- Below the ScanButton, add an informational section:\n  - View className=\"mx-6 mt-10 items-center\".\n  - Text \"Your Daily Aura Awaits\" in text-lg font-semibold text-white.\n  - Text \"Take a selfie and our AI will analyze your energy, mood, and personality.\" in text-sm text-gray-400 text-center mt-2 mx-4.\n  - Three benefit icons in a row (mt-6, flex-row, justify-center, space-x-6): camera (\"Selfie\"), sparkles (\"AI Analysis\"), share (\"Share\"). Each: items-center, icon in h-10 w-10 rounded-full bg-gray-800 items-center justify-center, label in text-xs text-gray-500 mt-1.\n\n4. ADD Greeting based on time of day:\n- Replace static \"Discover your energy today\" subtitle with dynamic greeting:\n  ```\n  const hour = new Date().getHours();\n  const greeting = hour \u003c 12 ? 'Good morning' : hour \u003c 18 ? 'Good afternoon' : 'Good evening';\n  ```\n- Show: `{greeting} âœ¨` in text-gray-400.",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_011",
      "title": "Mobile: Improve match screen UX with user ID display and copy button",
      "description": "The match screen requires manual entry of a UUID friend ID which is terrible UX. Must add a way for users to find and share their own ID.\n\nFile: mobile/app/(protected)/match.tsx (MODIFY)\n\n1. SHOW Current User's ID:\n- Import `useAuth` from '../../contexts/AuthContext'. Get `user` from context.\n- Above the friend ID input, add a \"Your ID\" card:\n  - View className=\"mx-6 mt-8 rounded-2xl bg-gray-800/50 p-4\".\n  - Row: Ionicons name=\"person-circle\" size={24} color=\"#8b5cf6\", Text \"Your ID\" in text-sm text-gray-400 ml-2.\n  - Below: Text with user.id in text-xs text-white font-mono (first 8 chars + \"...\" + last 4 chars for display).\n  - Copy button: TouchableOpacity with Ionicons name=\"copy-outline\" that calls `Clipboard.setStringAsync(user.id)` from 'expo-clipboard' (already available in Expo). Show hapticSuccess() and briefly change icon to checkmark for 2 seconds.\n  - Text \"Share this ID with friends so they can match with you\" in text-xs text-gray-500 mt-2.\n\n2. ADD Share My ID button:\n- Below the copy button row, add a TouchableOpacity:\n  - className=\"flex-row items-center justify-center bg-violet-600/20 rounded-full py-2 mt-3\"\n  - Ionicons name=\"share-outline\" + \"Share My ID\" text.\n  - On press: Share.share({ message: `Match auras with me on AuraSnap! My ID: ${user?.id}` }).\n\n3. IMPROVE Friend ID Input:\n- Add paste button inside the TextInput (absolute right-4): Ionicons name=\"clipboard-outline\" that reads from clipboard and sets friendId.\n- Add input validation: show red border if text is entered but not a valid UUID format (use regex /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i).\n\n4. ADD ActivityIndicator during loading:\n- When isLoading, show a full-screen overlay with ActivityIndicator and \"Analyzing compatibility...\" text, not just button text change.",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_012",
      "title": "Mobile: Add premium gating for unlimited scans and match features",
      "description": "Currently all features are completely ungated â€” premium subscription has zero effect on feature access. Must enforce subscription tiers.\n\nFile: mobile/app/(protected)/home.tsx (MODIFY)\n- Import useSubscription from '../../contexts/SubscriptionContext'.\n- Get `isSubscribed` from context.\n- In handleScan, after camera permission check and before API call:\n  - If NOT authenticated (guest mode), check guest scan counter (from enhance_005).\n  - If authenticated but NOT subscribed, check daily scan count. Store today's count in state, fetch from backend via GET /aura/today. If today's aura already exists, allow 1 re-scan (total 2/day for free). If they've scanned twice today and not subscribed, show Alert: \"Daily Limit Reached\" / \"Free users get 2 scans per day. Upgrade to Premium for unlimited scans!\" / buttons: [\"Upgrade\" â†’ router.push('/paywall'), \"OK\"].\n  - If subscribed, allow unlimited scans.\n\nFile: mobile/app/(protected)/match.tsx (MODIFY)\n- Import useSubscription.\n- In handleMatch, before API call, if !isSubscribed: show Alert \"Premium Feature\" / \"Aura compatibility matching is a premium feature.\" / buttons: [\"Upgrade\" â†’ router.push('/paywall'), \"Cancel\"]. Return early.\n- Add a lock icon overlay on the match input section for non-subscribers with text \"Premium Feature\" and an \"Unlock\" button.\n\nFile: mobile/app/(protected)/history.tsx (MODIFY)\n- Import useSubscription.\n- For non-subscribers, limit the displayed readings to the 5 most recent. Show a \"View All â€” Go Premium\" card after the 5th item in ReadingList:\n  - View with bg-violet-900/30 rounded-xl p-4 items-center.\n  - Lock icon + \"See your full aura history\" text.\n  - \"Upgrade\" button â†’ router.push('/paywall').\n\nFile: mobile/app/(protected)/settings.tsx (MODIFY)\n- If isSubscribed, show a \"Premium Member\" badge next to the user email with a sparkles icon and text-violet-400 text.",
      "status": "pending",
      "priority": 7,
      "depends_on": [
        "enhance_005"
      ],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_013",
      "title": "Mobile: Polish paywall screen with animated feature cards and pricing",
      "description": "The paywall screen works with RevenueCat but has minimal visual appeal. Must make it conversion-optimized.\n\nFile: mobile/app/(protected)/paywall.tsx (MODIFY)\n\n1. REDESIGN Header:\n- Replace generic header with a dark gradient hero: bg-gray-950 with a large AuraOrb (import from components/aura/AuraOrb, color='violet', size=120) centered at top.\n- Title: \"Unlock Your Full Aura\" in text-3xl font-bold text-white text-center.\n- Subtitle: \"See what your energy reveals\" in text-base text-gray-400 text-center mt-2.\n\n2. REDESIGN Feature List:\n- Instead of plain text list, use animated cards. Each feature in a View className=\"flex-row items-center mx-6 my-2 bg-gray-800/50 rounded-xl p-4\":\n  - Left: colored icon circle (h-10 w-10 rounded-full bg-{color}/20 items-center justify-center).\n  - Features with icons: \"Unlimited Scans\" (sparkles, violet), \"AI Compatibility\" (people, pink), \"Full History\" (time, green), \"Rare Aura Colors\" (color-palette, amber), \"No Ads\" (eye-off, blue), \"Priority Analysis\" (flash, orange).\n  - Right: Ionicons name=\"checkmark-circle\" size={20} color=\"#22c55e\".\n\n3. REDESIGN Package Cards:\n- For each RevenueCat package, create a selectable card:\n  - View className=\"mx-6 my-2 rounded-2xl border-2 p-5\" with border-violet-500 if selected, border-gray-700 if not.\n  - Show package title (e.g., \"Monthly\"), price (e.g., \"$4.99/mo\"), and savings badge for annual (\"Save 33%\" in bg-green-500 rounded-full px-2 py-0.5 text-xs text-white).\n  - Selected state: add a checkmark circle in top-right corner.\n- \"Most Popular\" badge on monthly package.\n\n4. FIX Purchase Button:\n- Large \"Start Free Trial\" button at bottom: bg-violet-600 rounded-full py-4 mx-6.\n- Below: \"Restore Purchases\" as text-only button in text-violet-400.\n- Below: Subscription terms in text-xs text-gray-500 text-center: \"Cancel anytime. Subscription automatically renews unless cancelled at least 24 hours before the end of the current period.\"\n\n5. ADD Close Button:\n- Top-right X button (Ionicons name=\"close\" size={24} color=\"#9ca3af\") to dismiss paywall. router.back().",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_014",
      "title": "Backend: Add daily scan rate limiting and user profile endpoint",
      "description": "Backend has no per-user rate limiting on aura scans and no profile endpoint. Must add these for the mobile gating to work properly.\n\nFile: backend/internal/services/aura_service.go (MODIFY)\n- Add method `GetTodayCount(userID uuid.UUID) (int64, error)`: count AuraReadings where user_id = userID AND created_at between today 00:00 and 23:59. Return count.\n- Add method `CanScan(userID uuid.UUID, isSubscribed bool) (bool, int, error)`: returns (allowed bool, remaining int, error). Logic: if isSubscribed, always return (true, -1, nil) meaning unlimited. If not subscribed, check GetTodayCount â€” if count \u003c 2, return (true, 2-count-1, nil). If count \u003e= 2, return (false, 0, nil).\n\nFile: backend/internal/dto/aura.go (MODIFY)\n- Add ScanEligibilityResponse struct: `CanScan bool, Remaining int, IsSubscribed bool`.\n\nFile: backend/internal/handlers/aura_handler.go (MODIFY)\n- Add handler method `CheckScanEligibility(c *fiber.Ctx)`: extracts userID, checks subscription status via DB query on Subscription model (status = 'active'), calls auraService.CanScan(), returns ScanEligibilityResponse.\n- In the existing Scan handler, add a pre-check: call CanScan before processing. If not allowed, return 429 with message \"Daily scan limit reached. Upgrade to Premium for unlimited scans.\"\n\nFile: backend/internal/routes/routes.go (MODIFY)\n- Add route: `aura.Get(\"/scan/check\", auraHandler.CheckScanEligibility)` â€” mobile app can call this to check before opening camera.\n\nFile: backend/internal/handlers/auth_handler.go (MODIFY)\n- Add `GetProfile(c *fiber.Ctx)` handler: returns user email, ID, subscription status, and current streak info. Query User + latest Subscription + latest AuraStreak.\n\nFile: backend/internal/routes/routes.go (MODIFY)\n- Add route: `auth.Get(\"/profile\", authHandler.GetProfile)` in the protected group.",
      "status": "pending",
      "priority": 8,
      "depends_on": [],
      "test_command": "cd backend \u0026\u0026 go build ./...",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    },
    {
      "id": "enhance_015",
      "title": "Mobile: Add animated scan result reveal with confetti-style celebration",
      "description": "After scanning, users are silently navigated to aura/[id]. Must add an exciting reveal animation.\n\nFile: mobile/app/(protected)/aura/[id].tsx (MODIFY)\n\n1. ADD Reveal Animation on Mount:\n- Import { useSharedValue, withTiming, withDelay, withSpring, Easing } from 'react-native-reanimated' and Animated from 'react-native-reanimated'.\n- Create shared values: `orbScale` (starts at 0), `contentOpacity` (starts at 0), `orbY` (starts at -50).\n- On data load complete, trigger sequence:\n  - orbScale: withSpring(1, { damping: 12, stiffness: 100 }) â€” bouncy entrance.\n  - orbY: withSpring(0, { damping: 15 }) â€” slides down into position.\n  - contentOpacity: withDelay(600, withTiming(1, { duration: 500 })) â€” content fades in after orb.\n- Wrap AuraOrb in Animated.View with animatedStyle using orbScale transform and orbY translateY.\n- Wrap content below orb in Animated.View with animatedStyle using contentOpacity.\n\n2. ADD Color Name Reveal:\n- After orb animation completes, show the aura color name with a typewriter-like effect:\n  - Use useState to track displayedChars, useEffect with setInterval (50ms per char) to increment from 0 to full length.\n  - Show `colorLabel.substring(0, displayedChars)` with a blinking cursor (| character that toggles opacity every 500ms).\n\n3. ADD Celebration Particles:\n- Create 8-12 small circles (h-2 w-2 rounded-full) with random positions around the orb.\n- Each particle: Animated.View with shared values for translateX, translateY, opacity, scale.\n- On mount: particles expand outward (translateX/Y randomized -100 to +100) while fading (opacity 1â†’0 over 1.5s).\n- Colors match the aura color and white.\n\n4. ADD Haptic Sequence:\n- On reveal start: hapticMedium().\n- After 600ms (content reveal): hapticSuccess().\n- Use setTimeout for the delayed haptic.\n\nThis creates a memorable \"wow moment\" that encourages sharing and repeat usage.",
      "status": "pending",
      "priority": 6,
      "depends_on": [],
      "test_command": "cd mobile \u0026\u0026 npx tsc --noEmit",
      "auto_commit": true,
      "created_at": "",
      "updated_at": ""
    }
  ]
}